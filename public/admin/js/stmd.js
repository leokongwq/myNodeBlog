/**
 * Created by zhangyanghong on 16/3/16.
 */
(function(R){var r="[!\"#$%&'()*+,./:;<=>?@[\\\\\\]^_`{|}~-]";var I="\\\\"+r;var aj='"('+I+'|[^"\\x00])*"';var D="'("+I+"|[^'\\x00])*'";var aq="\\(("+I+"|[^)\\x00])*\\)";var ad="[^\\\\()\\x00-\\x20]";var Q="\\(("+ad+"|"+I+")*\\)";var aE="[A-Za-z][A-Za-z0-9]*";var ay="(?:article|header|aside|hgroup|iframe|blockquote|hr|body|li|map|button|object|canvas|ol|caption|output|col|p|colgroup|pre|dd|progress|div|section|dl|table|td|dt|tbody|embed|textarea|fieldset|tfoot|figcaption|th|figure|thead|footer|footer|tr|form|ul|h1|h2|h3|h4|h5|h6|video|script|style)";var ae="[a-zA-Z_:][a-zA-Z0-9:._-]*";var x="[^\"'=<>`\\x00-\\x20]+";var U="'[^']*'";var B='"[^"]*"';var ac="(?:"+x+"|"+U+"|"+B+")";var X="(?:\\s*=\\s*"+ac+")";var at="(?:\\s+"+ae+X+"?)";var aA="<"+aE+at+"*\\s*/?>";var al="</"+aE+"\\s*[>]";var aC="<"+ay+at+"*\\s*/?>";var ak="</"+ay+"\\s*[>]";var e="<!--([^-]+|[-][^-]+)*-->";var V="[<][?].*?[?][>]";var au="<![A-Z]+\\s+[^>]*>";var o="<!\\[CDATA\\[([^\\]]+|\\][^\\]]|\\]\\][^>])*\\]\\]>";var t="(?:"+aA+"|"+al+"|"+e+"|"+V+"|"+au+"|"+o+")";var g="<(?:"+ay+"[\\s/>]|/"+ay+"[\\s>]|[?!])";var p=new RegExp("^"+t,"i");var N=new RegExp("^"+g,"i");var E=new RegExp('^(?:"('+I+'|[^"\\x00])*"|\'('+I+"|[^'\\x00])*'|\\(("+I+"|[^)\\x00])*\\))");var M=new RegExp("^(?:[<](?:[^<>\\n\\\\\\x00]|"+I+"|\\\\)*[>])");var F=new RegExp("^(?:"+ad+"+|"+I+"|"+Q+")*");var w=new RegExp(r);var G=new RegExp("\\\\("+r+")","g");var i=new RegExp("^\\\\("+r+")");var az=/\t/g;var l=/^(?:(?:\* *){3,}|(?:_ *){3,}|(?:- *){3,}) *$/;var m=/^(?:[\n`\[\]\\!<&*_]|[^\n`\[\]\\!<&*_]+)/m;var aD=function(aI){return aI.replace(G,"$1")};var q=function(aI){return/^\s*$/.test(aI)};var aa=function(aI){return aI.trim().replace(/\s+/," ").toUpperCase()};var aH=function(aK,aJ,aL){var aI=aJ.slice(aL).match(aK);if(aI){return aL+aI.index}else{return null}};var u=function(aJ){if(aJ.indexOf("\t")==-1){return aJ}else{var aI=0;return aJ.replace(az,function(aL,aM){var aK="    ".slice((aM-aI)%4);aI=aM+1;return aK})}};var an=function(aJ){var aI=aJ.exec(this.subject.slice(this.pos));if(aI){this.pos+=aI.index+aI[0].length;return aI[0]}else{return null}};var av=function(){return this.subject.charAt(this.pos)||null};var h=function(){this.match(/^ *(?:\n *)?/);return 1};var H=function(aK){var aN=this.pos;var aM=this.match(/^`+/);if(!aM){return 0}var aJ=this.pos;var aI=false;var aL;while(!aI&&(aL=this.match(/`+/m))){if(aL==aM){aK.push({t:"Code",c:this.subject.slice(aJ,this.pos-aM.length).replace(/[ \n]+/g," ").trim()});return(this.pos-aN)}}aK.push({t:"Str",c:aM});this.pos=aJ;return(this.pos-aN)};var S=function(aJ){var aI=this.subject,aK=this.pos;if(aI.charAt(aK)==="\\"){if(aI.charAt(aK+1)==="\n"){aJ.push({t:"Hardbreak"});this.pos=this.pos+2;return 2}else{if(w.test(aI.charAt(aK+1))){aJ.push({t:"Str",c:aI.charAt(aK+1)});this.pos=this.pos+2;return 2}else{this.pos++;aJ.push({t:"Str",c:"\\"});return 1}}}else{return 0}};var K=function(aJ){var aI;var aK;if((aI=this.match(/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/))){aK=aI.slice(1,-1);aJ.push({t:"Link",label:[{t:"Str",c:aK}],destination:"mailto:"+aK});return aI.length}else{if((aI=this.match(/^<(?:coap|doi|javascript|aaa|aaas|about|acap|cap|cid|crid|data|dav|dict|dns|file|ftp|geo|go|gopher|h323|http|https|iax|icap|im|imap|info|ipp|iris|iris.beep|iris.xpc|iris.xpcs|iris.lwz|ldap|mailto|mid|msrp|msrps|mtqp|mupdate|news|nfs|ni|nih|nntp|opaquelocktoken|pop|pres|rtsp|service|session|shttp|sieve|sip|sips|sms|snmp|soap.beep|soap.beeps|tag|tel|telnet|tftp|thismessage|tn3270|tip|tv|urn|vemmi|ws|wss|xcon|xcon-userid|xmlrpc.beep|xmlrpc.beeps|xmpp|z39.50r|z39.50s|adiumxtra|afp|afs|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|chrome|chrome-extension|com-eventbrite-attendee|content|cvs|dlna-playsingle|dlna-playcontainer|dtn|dvb|ed2k|facetime|feed|finger|fish|gg|git|gizmoproject|gtalk|hcp|icon|ipn|irc|irc6|ircs|itms|jar|jms|keyparc|lastfm|ldaps|magnet|maps|market|message|mms|ms-help|msnim|mumble|mvn|notes|oid|palm|paparazzi|platform|proxy|psyc|query|res|resource|rmi|rsync|rtmp|secondlife|sftp|sgn|skype|smb|soldat|spotify|ssh|steam|svn|teamspeak|things|udp|unreal|ut2004|ventrilo|view-source|webcal|wtai|wyciwyg|xfire|xri|ymsgr):[^<>\x00-\x20]*>/i))){aK=aI.slice(1,-1);aJ.push({t:"Link",label:[{t:"Str",c:aK}],destination:aK});return aI.length}else{return 0}}};var d=function(aJ){var aI=this.match(p);if(aI){aJ.push({t:"Html",c:aI});return aI.length}else{return 0}};var ai=function(aP){var aO=0;var aK=0;var aN,aJ;var aL=this.pos;aN=this.pos===0?"\n":this.subject.charAt(this.pos-1);while(this.peek()===aP){aO++;this.pos++}aJ=this.peek()||"\n";var aM=aO>0&&aO<=3&&!(/\s/.test(aJ));var aI=aO>0&&aO<=3&&!(/\s/.test(aN));if(aP==="_"){aM=aM&&!((/[a-z0-9]/i).test(aN));aI=aI&&!((/[a-z0-9]/i).test(aJ))}this.pos=aL;return{numdelims:aO,can_open:aM,can_close:aI}};var Y=function(aK){var aM=this.pos;var aP;var aN=0;var aJ=this.peek();if(aJ=="*"||aJ=="_"){aP=aJ}else{return 0}var aO;var aL;res=this.scanDelims(aP);aO=res.numdelims;this.pos+=aO;aK.push({t:"Str",c:this.subject.substr(this.pos-aO,aO)});aL=aK.length-1;if(!res.can_open||aO===0){return 0}var aI=0;switch(aO){case 1:while(true){res=this.scanDelims(aP);if(res.numdelims>=1&&res.can_close){this.pos+=1;aK[aL].t="Emph";aK[aL].c=aK.slice(aL+1);aK.splice(aL+1,aK.length-aL-1);break}else{if(this.parseInline(aK)===0){break}}}return(this.pos-aM);case 2:while(true){res=this.scanDelims(aP);if(res.numdelims>=2&&res.can_close){this.pos+=2;aK[aL].t="Strong";aK[aL].c=aK.slice(aL+1);aK.splice(aL+1,aK.length-aL-1);break}else{if(this.parseInline(aK)===0){break}}}return(this.pos-aM);case 3:while(true){res=this.scanDelims(aP);if(res.numdelims>=1&&res.numdelims<=3&&res.can_close&&res.numdelims!=aI){if(aI===1&&aO>2){res.numdelims=2}else{if(aI===2){res.numdelims=1}else{if(res.numdelims===3){res.numdelims=1}}}this.pos+=res.numdelims;if(aN>0){aK[aL].t=aI===1?"Strong":"Emph";aK[aL].c=[{t:aI===1?"Emph":"Strong",c:aK.slice(aL+1,aN)}].concat(aK.slice(aN+1));aK.splice(aL+1);break}else{aK.push({t:"Str",c:this.subject.slice(this.pos-res.numdelims,this.pos)});aN=aK.length-1;aI=res.numdelims}}else{if(this.parseInline(aK)===0){break}}}return(this.pos-aM);default:return res}return 0};var A=function(){var aI=this.match(E);if(aI){return aD(aI.substr(1,aI.length-2))}else{return null}};var J=function(){var aI=this.match(M);if(aI){return aD(aI.substr(1,aI.length-2))}else{aI=this.match(F);if(aI!==null){return aD(aI)}else{return null}}};var y=function(){if(this.peek()!="["){return 0}var aJ=this.pos;var aI=0;if(this.label_nest_level>0){this.label_nest_level--;return 0}this.pos++;var aK;while((aK=this.peek())&&(aK!="]"||aI>0)){switch(aK){case"`":this.parseBackticks([]);break;case"<":this.parseAutolink([])||this.parseHtmlTag([])||this.parseString([]);break;case"[":aI++;this.pos++;break;case"]":aI--;this.pos++;break;case"\\":this.parseEscaped([]);break;default:this.parseString([])}}if(aK==="]"){this.label_nest_level=0;this.pos++;return this.pos-aJ}else{if(!aK){this.label_nest_level=aI}this.pos=aJ;return 0}};var O=function(aI){return new j().parse(aI.substr(1,aI.length-2),{})};var Z=function(aN){var aM=this.pos;var aK;var aJ;var aS;var aR;aJ=this.parseLinkLabel();if(aJ===0){return 0}var aP=this.pos;var aL=this.subject.substr(aM,aJ);if(this.peek()=="("){this.pos++;if(this.spnl()&&((aS=this.parseLinkDestination())!==null)&&this.spnl()&&(/^\s/.test(this.subject.charAt(this.pos-1))&&(aR=this.parseLinkTitle()||"")||true)&&this.spnl()&&this.match(/^\)/)){aN.push({t:"Link",destination:aS,title:aR,label:O(aL)});return this.pos-aM}else{this.pos=aM;return 0}}var aI=this.pos;this.spnl();var aO=this.pos;aJ=this.parseLinkLabel();if(aJ==2){aK=aL}else{if(aJ>0){aK=this.subject.slice(aO,aO+aJ)}else{this.pos=aI;aK=aL}}var aQ=this.refmap[aa(aK)];if(aQ){aN.push({t:"Link",destination:aQ.destination,title:aQ.title,label:O(aL)});return this.pos-aM}else{this.pos=aM;return 0}this.pos=aM;return 0};var aB=function(aJ){var aI;if((aI=this.match(/^&(?:#x[a-f0-9]{1,8}|#[0-9]{1,8}|[a-z][a-z0-9]{1,31});/i))){aJ.push({t:"Entity",c:aI});return aI.length}else{return 0}};var a=function(aJ){var aI;if((aI=this.match(m))){aJ.push({t:"Str",c:aI});return aI.length}else{return 0}};var c=function(aI){if(this.peek()=="\n"){this.pos++;var aJ=aI[aI.length-1];if(aJ&&aJ.t=="Str"&&aJ.c.slice(-2)=="  "){aJ.c=aJ.c.replace(/ *$/,"");aI.push({t:"Hardbreak"})}else{if(aJ&&aJ.t=="Str"&&aJ.c.slice(-1)==" "){aJ.c=aJ.c.slice(0,-1)}aI.push({t:"Softbreak"})}return 1}else{return 0}};var aF=function(aI){if(this.match(/^!/)){var aJ=this.parseLink(aI);if(aJ===0){aI.push({t:"Str",c:"!"});return 1}else{if(aI[aI.length-1]&&aI[aI.length-1].t=="Link"){aI[aI.length-1].t="Image";return aJ+1}else{throw"Shouldn't happen"}}}else{return 0}};var ab=function(aR,aM){this.subject=aR;this.pos=0;var aJ;var aP;var aN;var aQ;var aK=this.pos;var aI;aQ=this.parseLinkLabel();if(aQ===0){return 0}else{aJ=this.subject.substr(0,aQ)}if(this.peek()===":"){this.pos++}else{this.pos=aK;return 0}this.spnl();aP=this.parseLinkDestination();if(aP===null||aP.length===0){this.pos=aK;return 0}var aL=this.pos;this.spnl();aN=this.parseLinkTitle();if(aN===null){aN="";this.pos=aL}if(this.match(/^ *(?:\n|$)/)===null){this.pos=aK;return 0}var aO=aa(aJ);if(!aM[aO]){aM[aO]={destination:aP,title:aN}}return this.pos-aK};var L=function(aI){var aK=this.peek();var aJ;switch(aK){case"\n":aJ=this.parseNewline(aI);break;case"\\":aJ=this.parseEscaped(aI);break;case"`":aJ=this.parseBackticks(aI);break;case"*":case"_":aJ=this.parseEmphasis(aI);break;case"[":aJ=this.parseLink(aI);break;case"!":aJ=this.parseImage(aI);break;case"<":aJ=this.parseAutolink(aI)||this.parseHtmlTag(aI);break;case"&":aJ=this.parseEntity(aI);break;default:}return aJ||this.parseString(aI)};var W=function(aJ,aK){this.subject=aJ;this.pos=0;this.refmap=aK||{};var aI=[];while(this.parseInline(aI)){}return aI};function j(){return{subject:"",label_nest_level:0,pos:0,refmap:{},match:an,peek:av,spnl:h,parseBackticks:H,parseEscaped:S,parseAutolink:K,parseHtmlTag:d,scanDelims:ai,parseEmphasis:Y,parseLinkTitle:A,parseLinkDestination:J,parseLinkLabel:y,parseLink:Z,parseEntity:aB,parseString:a,parseNewline:c,parseImage:aF,parseReference:ab,parseInline:L,parse:W}}var z=function(aI,aK,aJ){return{t:aI,open:true,last_line_blank:false,start_line:aK,start_column:aJ,end_line:aK,children:[],parent:null,string_content:"",strings:[],inline_content:[]}};var s=function(aJ,aI){return(aJ=="Document"||aJ=="BlockQuote"||aJ=="ListItem"||(aJ=="List"&&aI=="ListItem"))};var P=function(aI){return(aI=="Paragraph"||aI=="IndentedCode"||aI=="FencedCode")};var aw=function(aI){if(aI.last_line_blank){return true}if((aI.t=="List"||aI.t=="ListItem")&&aI.children.length>0){return aw(aI.children[aI.children.length-1])}else{return false}};var k=function(aL,aJ){var aI=aL;var aK=null;do{if(aI.t==="List"){aK=aI}aI=aI.parent}while(aI);if(aK){while(aL!=aK){this.finalize(aL,aJ);aL=aL.parent}this.finalize(aK,aJ);this.tip=aK.parent}};var ao=function(aJ,aK){var aI=aJ.slice(aK);if(!(this.tip.open)){throw ({msg:"Attempted to add line ("+aJ+") to closed container."})}this.tip.strings.push(aI)};var ar=function(aI,aJ,aK){while(!s(this.tip.t,aI)){this.finalize(this.tip,aJ)}var aM=aK+1;var aL=z(aI,aJ,aM);this.tip.children.push(aL);aL.parent=this.tip;this.tip=aL;return aL};var C=function(aL,aO){var aK=aL.slice(aO);var aJ;var aN;var aM={};if(aK.match(l)){return null}if((aJ=aK.match(/^[*+-]( +|$)/))){aN=aJ[1].length;aM.type="Bullet";aM.bullet_char=aJ[0].charAt(0)}else{if((aJ=aK.match(/^(\d+)([.)])( +|$)/))){aN=aJ[3].length;aM.type="Ordered";aM.start=parseInt(aJ[1]);aM.delimiter=aJ[2]}else{return null}}var aI=aJ[0].length===aK.length;if(aN>=5||aN<1||aI){aM.padding=aJ[0].length-aN+1}else{aM.padding=aJ[0].length}return aM};var b=function(aJ,aI){return(aJ.type===aI.type&&aJ.delimiter===aI.delimiter&&aJ.bullet_char===aI.bullet_char)};var n=function(aQ,a0){var aL=true;var aW;var aV;var aM=0;var aN;var aZ;var aO;var aR;var aK;var aY;var aT=4;var aS=this.doc;var aX=this.tip;aQ=u(aQ);while(aS.children.length>0){aW=aS.children[aS.children.length-1];if(!aW.open){break}aS=aW;aN=aH(/[^ ]/,aQ,aM);if(aN===null){aV=aQ.length;aO=true}else{aV=aN;aO=false}aR=aV-aM;switch(aS.t){case"BlockQuote":var aP=aR<=3&&aQ.charAt(aV)===">";if(aP){aM=aV+1;if(aQ.charAt(aM)===" "){aM++}}else{aL=false}break;case"ListItem":if(aR>=aS.list_data.marker_offset+aS.list_data.padding){aM+=aS.list_data.marker_offset+aS.list_data.padding}else{if(aO){aM=aV}else{aL=false}}break;case"IndentedCode":if(aR>=aT){aM+=aT}else{if(aO){aM=aV}else{aL=false}}break;case"ATXHeader":case"SetextHeader":case"HorizontalRule":aL=false;break;case"FencedCode":aY=aS.fence_offset;while(aY>0&&aQ.charAt(aM)===" "){aM++;aY--}break;case"HtmlBlock":if(aO){aL=false}break;case"Paragraph":if(aO){aS.last_line_blank=true;aL=false}break;default:}if(!aL){aS=aS.parent;break}}aK=aS;var aI=function(a1){while(!a2&&aX!=aK){a1.finalize(aX,a0);aX=aX.parent}var a2=true};if(aO&&aS.last_line_blank){this.breakOutOfLists(aS,a0)}while(aS.t!="FencedCode"&&aS.t!="IndentedCode"&&aS.t!="HtmlBlock"&&aH(/^[ #`~*+_=<>0-9-]/,aQ,aM)!==null){aN=aH(/[^ ]/,aQ,aM);if(aN===null){aV=aQ.length;aO=true}else{aV=aN;aO=false}aR=aV-aM;if(aR>=aT){if(this.tip.t!="Paragraph"&&!aO){aM+=aT;aI(this);aS=this.addChild("IndentedCode",a0,aM)}else{break}}else{if(aQ.charAt(aV)===">"){aM=aV+1;if(aQ.charAt(aM)===" "){aM++}aI(this);aS=this.addChild("BlockQuote",a0,aM)}else{if((aN=aQ.slice(aV).match(/^#{1,6}(?: +|$)/))){aM=aV+aN[0].length;aI(this);aS=this.addChild("ATXHeader",a0,aV);aS.level=aN[0].trim().length;aS.strings=[aQ.slice(aM).replace(/(?:(\\#) *#*| *#+) *$/,"$1")];break}else{if((aN=aQ.slice(aV).match(/^`{3,}(?!.*`)|^~{3,}(?!.*~)/))){var aU=aN[0].length;aI(this);aS=this.addChild("FencedCode",a0,aV);aS.fence_length=aU;aS.fence_char=aN[0].charAt(0);aS.fence_offset=aV-aM;aM=aV+aU;break}else{if(aH(N,aQ,aV)!==null){aI(this);aS=this.addChild("HtmlBlock",a0,aV);break}else{if(aS.t=="Paragraph"&&aS.strings.length===1&&((aN=aQ.slice(aV).match(/^(?:=+|-+) *$/)))){aI(this);aS.t="SetextHeader";aS.level=aN[0].charAt(0)==="="?1:2;aM=aQ.length}else{if(aH(l,aQ,aV)!==null){aI(this);aS=this.addChild("HorizontalRule",a0,aV);aM=aQ.length-1;break}else{if((aZ=C(aQ,aV))){aI(this);aZ.marker_offset=aR;aM=aV+aZ.padding;if(aS.t!=="List"||!(b(aS.list_data,aZ))){aS=this.addChild("List",a0,aV);aS.list_data=aZ}aS=this.addChild("ListItem",a0,aV);aS.list_data=aZ}else{break}}}}}}}}if(P(aS.t)){break}}aN=aH(/[^ ]/,aQ,aM);if(aN===null){aV=aQ.length;aO=true}else{aV=aN;aO=false}aR=aV-aM;if(this.tip!==aK&&!aO&&this.tip.t=="Paragraph"&&this.tip.strings.length>0){this.last_line_blank=false;this.addLine(aQ,aM)}else{aI(this);aS.last_line_blank=aO&&!(aS.t=="BlockQuote"||aS.t=="FencedCode"||(aS.t=="ListItem"&&aS.children.length===0&&aS.start_line==a0));var aJ=aS;while(aJ.parent){aJ.parent.last_line_blank=false;aJ=aJ.parent}switch(aS.t){case"IndentedCode":case"HtmlBlock":this.addLine(aQ,aM);break;case"FencedCode":aN=(aR<=3&&aQ.charAt(aV)==aS.fence_char&&aQ.slice(aV).match(/^(?:`{3,}|~{3,})(?= *$)/));if(aN&&aN[0].length>=aS.fence_length){this.finalize(aS,a0)}else{this.addLine(aQ,aM)}break;case"ATXHeader":case"SetextHeader":case"HorizontalRule":break;default:if(P(aS.t)){this.addLine(aQ,aV)}else{if(aO){}else{if(aS.t!="HorizontalRule"&&aS.t!="SetextHeader"){aS=this.addChild("Paragraph",a0,aV);this.addLine(aQ,aV)}else{console.log("Line "+a0.toString()+" with container type "+aS.t+" did not match any condition.")}}}}}};var aG=function(aK,aI){var aN;if(!aK.open){return 0}aK.open=false;if(aI>aK.start_line){aK.end_line=aI-1}else{aK.end_line=aI}switch(aK.t){case"Paragraph":aK.string_content=aK.strings.join("\n").replace(/^  */m,"");while(aK.string_content.charAt(0)==="["&&(aN=this.inlineParser.parseReference(aK.string_content,this.refmap))){aK.string_content=aK.string_content.slice(aN);if(q(aK.string_content)){aK.t="ReferenceDef";break}}break;case"ATXHeader":case"SetextHeader":case"HtmlBlock":aK.string_content=aK.strings.join("\n");break;case"IndentedCode":aK.string_content=aK.strings.join("\n").replace(/(\n *)*$/,"\n");break;case"FencedCode":aK.info=aD(aK.strings[0].trim());if(aK.strings.length==1){aK.string_content=""}else{aK.string_content=aK.strings.slice(1).join("\n")+"\n"}break;case"List":aK.tight=true;var aQ=aK.children.length;var aM=0;while(aM<aQ){var aS=aK.children[aM];var aP=aM==aQ-1;if(aw(aS)&&!aP){aK.tight=false;break}var aR=aS.children.length;var aL=0;while(aL<aR){var aO=aS.children[aL];var aJ=aL==aR-1;if(aw(aO)&&!(aP&&aJ)){aK.tight=false;break}aL++}aM++}break;default:break}this.tip=aK.parent||this.top};var f=function(aJ){switch(aJ.t){case"Paragraph":case"SetextHeader":case"ATXHeader":aJ.inline_content=this.inlineParser.parse(aJ.string_content.trim(),this.refmap);aJ.string_content="";break;default:break}if(aJ.children){for(var aI=0;aI<aJ.children.length;aI++){this.processInlines(aJ.children[aI])}}};var ah=function(aK){this.doc=z("Document",1,1);this.tip=this.doc;this.refmap={};var aJ=aK.replace(/\n$/,"").split(/\r\n|\n|\r/);var aI=aJ.length;for(var aL=0;aL<aI;aL++){this.incorporateLine(aJ[aL],aL+1)}while(this.tip){this.finalize(this.tip,aI-1)}this.processInlines(this.doc);return this.doc};function af(){return{doc:z("Document",1,1),tip:this.doc,refmap:{},inlineParser:new j(),breakOutOfLists:k,addLine:ao,addChild:ar,incorporateLine:n,finalize:aG,processInlines:f,parse:ah}}var T=function(aJ,aO,aM,aL){var aI="<"+aJ;if(aO){var aK=0;var aN;while((aN=aO[aK])!==undefined){aI=aI.concat(" ",aN[0],'="',aN[1],'"');aK++}}if(aM){aI=aI.concat(">",aM,"</",aJ,">")}else{if(aL){aI=aI+" />"}else{aI=aI.concat("></",aJ,">")}}return aI};var ap=function(aJ){var aI;switch(aJ.t){case"Str":return this.escape(aJ.c);case"Softbreak":return this.softbreak;case"Hardbreak":return T("br",[],"",true)+"\n";case"Emph":return T("em",[],this.renderInlines(aJ.c));case"Strong":return T("strong",[],this.renderInlines(aJ.c));case"Html":return aJ.c;case"Entity":return aJ.c;case"Link":aI=[["href",this.escape(aJ.destination,true)]];if(aJ.title){aI.push(["title",this.escape(aJ.title,true)])}return T("a",aI,this.renderInlines(aJ.label));case"Image":aI=[["src",this.escape(aJ.destination,true)],["alt",this.escape(this.renderInlines(aJ.label))]];if(aJ.title){aI.push(["title",this.escape(aJ.title,true)])}return T("img",aI,"",true);case"Code":return T("code",[],this.escape(aJ.c));default:console.log("Uknown inline type "+aJ.t);return""}};var v=function(aJ){var aI="";for(var aK=0;aK<aJ.length;aK++){aI=aI+this.renderInline(aJ[aK])}return aI};var ag=function(aO,aL){var aJ;var aI;var aK;switch(aO.t){case"Document":var aN=this.renderBlocks(aO.children);return(aN===""?"":aN+"\n");case"Paragraph":if(aL){return this.renderInlines(aO.inline_content)}else{return T("p",[],this.renderInlines(aO.inline_content))}break;case"BlockQuote":var aM=this.renderBlocks(aO.children);return T("blockquote",[],aM===""?this.innersep:this.innersep+this.renderBlocks(aO.children)+this.innersep);case"ListItem":return T("li",[],this.renderBlocks(aO.children,aL).trim());case"List":aJ=aO.list_data.type=="Bullet"?"ul":"ol";aI=(!aO.list_data.start||aO.list_data.start==1)?[]:[["start",aO.list_data.start.toString()]];return T(aJ,aI,this.innersep+this.renderBlocks(aO.children,aO.tight)+this.innersep);case"ATXHeader":case"SetextHeader":aJ="h"+aO.level;return T(aJ,[],this.renderInlines(aO.inline_content));case"IndentedCode":return T("pre",[],T("code",[],this.escape(aO.string_content)));case"FencedCode":aK=aO.info.split(/ +/);aI=aK.length===0||aK[0].length===0?[]:[["class","language-"+this.escape(aK[0],true)]];return T("pre",[],T("code",aI,this.escape(aO.string_content)));case"HtmlBlock":return aO.string_content;case"ReferenceDef":return"";case"HorizontalRule":return T("hr",[],"",true);default:console.log("Uknown block type "+aO.t);return""}};var am=function(aL,aK){var aI=[];for(var aJ=0;aJ<aL.length;aJ++){if(aL[aJ].t!=="ReferenceDef"){aI.push(this.renderBlock(aL[aJ],aK))}}return aI.join(this.blocksep)};function ax(){return{blocksep:"\n",innersep:"\n",softbreak:"\n",escape:function(aI,aJ){if(aJ){return aI.replace(/[&](?![#](x[a-f0-9]{1,8}|[0-9]{1,8});|[a-z][a-z0-9]{1,31};)/gi,"&amp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;").replace(/["]/g,"&quot;")}else{return aI.replace(/[&]/g,"&amp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;").replace(/["]/g,"&quot;")}},renderInline:ap,renderInlines:v,renderBlock:ag,renderBlocks:am,render:ag}}R.DocParser=af;R.HtmlRenderer=ax})(typeof exports==="undefined"?this.stmd={}:exports);